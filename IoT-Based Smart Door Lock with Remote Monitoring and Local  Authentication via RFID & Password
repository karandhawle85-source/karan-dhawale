#include <Wire.h> 
#include <LiquidCrystal_I2C.h> 
#include <Servo.h> 
#include <Keypad.h> 
#include <SPI.h> 
#include <MFRC522.h> 
#define SS_PIN 10 // RFID SS (SDA) pin 
#define RST_PIN 9 // RFID Reset pin 
#define SERVO_PIN 6 // Servo motor pin 
MFRC522 rfid(SS_PIN, RST_PIN); 
Servo doorServo; 
LiquidCrystal_I2C lcd(0x27, 16, 2); 
// Keypad configuration 
const byte ROWS = 4; 
const byte COLS = 4; 
char keys[ROWS][COLS] = { 
{'1', '2', '3', 'A'}, 
{'4', '5', '6', 'B'}, 
{'7', '8', '9', 'C'}, 
{'*', '0', '#', 'D'} // Changed '#' to lock door 
}; 
byte rowPins[ROWS] = {A0, A1, A2, A3}; // Keypad row pins 
byte colPins[COLS] = {5, 4, 3, 2}; 
// Keypad column pins 
Keypad keypad = Keypad(makeKeymap(keys), rowPins, colPins, ROWS, COLS); 
// Authentication details 
String correctPassword = "1325"; 
String enteredPassword = ""; 
String validRFID = "A3723DA"; // Correct UID without spaces 
void setup() { 
Serial.begin(9600); 
SPI.begin(); 
rfid.PCD_Init(); 
lcd.init(); 
lcd.backlight(); 
doorServo.attach(SERVO_PIN); 
doorServo.write(0); // Keep door locked initially 
resetDisplay(); // Show initial message 
} 

void loop() { 
checkRFID(); 
checkKeypad(); 
} 
// Function to scan and validate RFID card 
void checkRFID() { 
if (rfid.PICC_IsNewCardPresent() && rfid.PICC_ReadCardSerial()) { 
String tagID = ""; 
for (byte i = 0; i < rfid.uid.size; i++) { 
tagID += String(rfid.uid.uidByte[i], HEX); // Convert UID to HEX 
} 
tagID.toUpperCase(); // Convert to uppercase for consistency 
Serial.println("Scanned Card UID: " + tagID); // Debugging output 
if (tagID.equals(validRFID)) { 
unlockDoor(); 
} else { 
lcd.clear(); 
lcd.print("Invalid Card!"); 
delay(2000); 
resetDisplay(); 
} 
rfid.PICC_HaltA(); 
rfid.PCD_StopCrypto1(); 
} 
} 
// Function to handle keypad input 
void checkKeypad() { 
char key = keypad.getKey(); 
if (key) { 
if (key == '*') { // Check password 
if (enteredPassword == correctPassword) { 
unlockDoor(); 
} else { 
lcd.clear(); 
lcd.print("Access Denied"); 
delay(2000); 
resetDisplay(); 
} 
enteredPassword = "";

} 
else if (key == '#') { // Lock door when '#' is pressed 
lockDoor(); 
} 
else { // Store entered password 
enteredPassword += key; 
lcd.clear(); // Remove previous text and show only password 
lcd.setCursor(0, 0); 
lcd.print(enteredPassword); 
} 
} 
} 
// Function to unlock door 
void unlockDoor() { 
lcd.clear(); 
lcd.print("Access Granted"); 
doorServo.write(90); 
delay(2000); 
lcd.clear(); 
lcd.setCursor(0, 0); 
lcd.print("Press # to Lock"); 
} 
// Function to lock door 
void lockDoor() { 
lcd.clear(); 
lcd.print("Door Locked"); 
doorServo.write(0); 
delay(2000); 
resetDisplay(); 
} 
// Function to reset display to default 
void resetDisplay() { 
enteredPassword = ""; 
lcd.clear(); 
lcd.setCursor(0, 0); 
lcd.print("Scan Card or"); 
lcd.setCursor(0, 1); 
lcd.print("Enter Pass"); 
}
